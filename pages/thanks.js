import Head from "next/head";

import clientPromise from "@/util/mongodb";
import Layout from "@/components/Layout";

export default function ThanksPage({ users }) {
  return (
    <Layout>
      <Head>
        <title>Thanks! - Drone Delivery</title>
        <meta name="description" content="Generated by create next app" />
      </Head>

      <div className="flex flex-col items-center mt-32">
        <h1 className="text-3xl">Drone Delivery</h1>
        <p>Thanks for signing up!</p>
      </div>
      <div className="mt-5 text-center">
        <h2 className="text-xl">Join our list of happy customers!</h2>
        {users.map((user) => {
          return <div key={user._id}>{user.name}</div>;
        })}
      </div>
    </Layout>
  );
}

export async function getServerSideProps(context) {
  // client.db() will be the default database passed in the MONGODB_URI
  // You can change the database by calling the client.db() function and specifying a database like:
  // const db = client.db("myDatabase");
  // Then you can execute queries against your database like so:
  // db.find({}) or any of the MongoDB Node Driver commands

  const client = await clientPromise;
  const db = client.db("drone-delivery");
  const data = await db.collection("users").find({}).limit(20).toArray();
  const users = JSON.parse(JSON.stringify(data));

  return {
    props: { users: users },
  };
}
